!function(e){"use strict";e(function(){var n=!1;function t(t){var i=null;if(n)return void 0!==t&&void 0!==t.data&&(void 0===t.data.preserveGranitoCheckoutSubmitValue||t.data.preserveGranitoCheckoutSubmitValue||(n=!1)),!0;if(!e("#payment_method_granito-credit-card").is(":checked"))return!0;if(0<e("input[name=granito_checkout_token]").length)return!0;if(1===e("input#terms").length&&0===e("input#terms:checked").length)return!0;if(e("#createaccount").is(":checked")&&e("#account_password").length&&""===e("#account_password").val())return!0;if((i=e("#ship-to-different-address-checkbox").is(":checked")?e(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required"):e(".woocommerce-billing-fields .validate-required")).length){var r=!1;if(0<e("#billing_persontype").length?(i.each(function(){""===e(this).find("input.input-text, select").not(e("#account_password, #account_username, #billing_cpf, #billing_rg, #billing_cnpj, #billing_company, #billing_ie")).val()&&(r=!0)}),r||(r=function(){var n=!1;return"1"===e("#billing_persontype").val()?e("#billing_cpf, #billing_rg").each(function(){""===e(this).val()&&(n=!0)}):"2"===e("#billing_persontype").val()&&e("#billing_cnpj, #billing_company, #billing_ie").each(function(){""===e(this).val()&&(n=!0)}),n}())):i.each(function(){""===e(this).find("input.input-text, select").not(e("#account_password, #account_username")).val()&&(r=!0)}),r)return!0}return!1}function i(e){return 0<e.length}function r(e){return e.replace(/[^\d]/g,"")}function a(){if(t())return!0;var a,o,l,c=e("form.checkout, form#order_review"),s=e("#granito-checkout-params",c);a=new GranitoCheckout.Checkout({encryption_key:wcGranitoParams.encryptionKey,success:function(t){n=!0,"no"===wcGranitoParams.register_refused_order?(e("input[name=granito_checkout_token]",c).remove(),c.append(e('<input name="granito_checkout_token" type="hidden" />').val(t.token))):(e("input[name=granito_card_hash]",c).remove(),e("input[name=granito_installments]",c).remove(),c.append(e('<input name="granito_card_hash" type="hidden" />').val(t.card_hash)),c.append(e('<input name="granito_installments" type="hidden" />').val(t.installments))),c.submit()}}),o=wcGranitoParams.checkoutPayPage?wcGranitoParams.customerFields:function(n){var t,a={};return a.customerName=e.trim(e("#billing_first_name",n).val()+" "+e("#billing_last_name",n).val()),a.customerEmail=e("#billing_email",n).val(),i(e("#billing_address_1"))&&(a.customerAddressStreet=e("#billing_address_1").val(),a.customerAddressCity=e("#billing_city").val(),a.customerAddressState=e("#billing_state").val(),a.customerAddressComplementary=e("#billing_address_2").val(),a.customerAddressZipcode=r(e("#billing_postcode").val()),i(e("#billing_number"))&&(a.customerAddressStreetNumber=e("#billing_number").val()),i(e("#billing_neighborhood"))&&(a.customerAddressNeighborhood=e("#billing_neighborhood").val())),i(e("#billing_phone"))&&(t=r(e("#billing_phone").val()),a.customerPhoneDdd=t.substr(0,2),a.customerPhoneNumber=t.substr(2)),i(e("#billing_persontype"))?"1"===e("#billing_persontype").val()?a.customerDocumentNumber=r(e("#billing_cpf").val()):(a.customerName=e("#billing_company").val(),a.customerDocumentNumber=r(e("#billing_cnpj").val())):i(e("#billing_cpf"))?a.customerDocumentNumber=r(e("#billing_cpf").val()):i(e("#billing_cnpj"))&&(a.customerName=e("#billing_company").val(),a.customerDocumentNumber=r(e("#billing_cnpj").val())),a}(c);const u="yes"===wcGranitoParams.register_refused_order?"false":"true";return l=e.extend({},{paymentMethods:"credit_card",customerData:!1,amount:s.data("total"),createToken:u,interestRate:wcGranitoParams.interestRate,maxInstallments:s.data("max_installment"),freeInstallments:wcGranitoParams.freeInstallments,postbackUrl:wcGranitoParams.postbackUrl,uiColor:wcGranitoParams.uiColor},o),a.open(l),!1}e("form.checkout").on("click","#place_order",function(){return a()}),e("form.checkout").on("checkout_place_order_granito-credit-card",{preserveGranitoCheckoutSubmitValue:!0},t),e("form#order_review").submit(function(){return a()})})}(jQuery);